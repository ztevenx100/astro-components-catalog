---
import ThemeToggle from '../components/ThemeToggle.astro';
import BackToTopButton from '../components/util/BackToTopButton.astro';

// Importar CSS crítico inline para better performance
import '../styles/critical.css';

export interface Props {
	title: string;
}

const { title } = Astro.props;
---

<!doctype html>
<html lang="es">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content="Catálogo de componentes CSS puros - Colección de componentes visuales modernos hechos con HTML y CSS" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>
		
		<!-- Optimizaciones de rendimiento -->
		<meta name="theme-color" content="#667eea" />
		<meta name="color-scheme" content="light dark" />
		
		<!-- Preload critical resources -->
		<link rel="preload" href="/src/utils/componentUtils.js" as="script" type="module" />
		
		<!-- DNS prefetch para recursos externos -->
		<link rel="dns-prefetch" href="//fonts.googleapis.com" />
		<link rel="dns-prefetch" href="//fonts.gstatic.com" />
		
		<!-- Preconnect para fuentes críticas -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		
		<!-- Load fonts optimally -->
		<link 
			href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap" 
			rel="stylesheet" 
			media="print" 
			onload="this.media='all'"
		/>
		<noscript>
			<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet" />
		</noscript>
		
		<!-- Progressive enhancement hint -->
		<script>
			// Detect JS support and add class
			document.documentElement.classList.add('js-enabled');
			
			// Early theme detection
			const theme = localStorage.getItem('theme') || 
				(window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
			document.documentElement.classList.add(theme);
		</script>
		
		<!-- Resource hints for lazy-loaded content -->
		<link rel="prefetch" href="/src/components/ui/cards/" />
		<link rel="prefetch" href="/src/components/ui/forms/" />
		<link rel="prefetch" href="/src/components/ui/interactive/" />
	</head>
	<body>
		<!-- Skip to content for accessibility -->
		<a href="#main-content" class="visually-hidden">Saltar al contenido principal</a>
		
		<ThemeToggle />
		
		<main id="main-content">
			<slot />
		</main>
		
		<BackToTopButton />
		
		<!-- Load non-critical CSS asynchronously -->
		<script>
			// Lazy load non-critical CSS
			const loadCSS = (href) => {
				const link = document.createElement('link');
				link.rel = 'stylesheet';
				link.href = href;
				document.head.appendChild(link);
			};
			
			// Load theme utilities after initial render
			setTimeout(() => {
				loadCSS('/src/styles/theme-utilities.css');
				loadCSS('/src/styles/utilities.css');
			}, 100);
		</script>
	</body>
</html>

<style is:global>
	* {
		margin: 0;
		padding: 0;
		box-sizing: border-box;
	}

	:root {
		/* Colores principales */
		--primary-color: #3b82f6;
		--primary-hover: #2563eb;
		--primary-light: #dbeafe;
		--primary-dark: #1e40af;
		
		/* Colores de superficie */
		--bg-color: #ffffff;
		--surface-color: #f8fafc;
		--surface-hover: #f1f5f9;
		--surface-secondary: #e2e8f0;
		
		/* Colores de texto */
		--text-color: #1e293b;
		--text-secondary: #64748b;
		--text-muted: #94a3b8;
		
		/* Colores de borde */
		--border-color: #e2e8f0;
		--border-light: #f1f5f9;
		--border-dark: #cbd5e1;
		
		/* Sombras */
		--shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
		--shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
		--shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
		
		/* Gradientes */
		--gradient-bg: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
		--gradient-primary: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
		
		/* Transiciones */
		--transition-fast: 0.15s ease;
		--transition-normal: 0.3s ease;
		--transition-slow: 0.5s ease;
	}

	html.dark {
		/* Colores principales en modo oscuro */
		--primary-color: #60a5fa;
		--primary-hover: #3b82f6;
		--primary-light: #1e3a8a;
		--primary-dark: #93c5fd;
		
		/* Colores de superficie */
		--bg-color: #0f172a;
		--surface-color: #1e293b;
		--surface-hover: #334155;
		--surface-secondary: #475569;
		
		/* Colores de texto */
		--text-color: #f1f5f9;
		--text-secondary: #cbd5e1;
		--text-muted: #94a3b8;
		
		/* Colores de borde */
		--border-color: #334155;
		--border-light: #475569;
		--border-dark: #64748b;
		
		/* Sombras */
		--shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.3);
		--shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.4), 0 2px 4px -2px rgb(0 0 0 / 0.4);
		--shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.4), 0 4px 6px -4px rgb(0 0 0 / 0.4);
		
		/* Gradientes */
		--gradient-bg: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
		--gradient-primary: linear-gradient(135deg, #60a5fa 0%, #3b82f6 100%);
	}

	html {
		font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
		background: var(--gradient-bg);
		color: var(--text-color);
		min-height: 100vh;
		transition: background var(--transition-normal), color var(--transition-normal);
	}

	body {
		line-height: 1.6;
		min-height: 100vh;
		background-color: transparent;
		transition: background-color var(--transition-normal);
	}

	main {
		min-height: 100vh;
		padding: 2rem;
	}

	/* Mejoras para el código */
	code {
		font-family: 'Fira Code', 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
		background: var(--surface-secondary);
		color: var(--text-color);
		padding: 0.25rem 0.5rem;
		border-radius: 0.375rem;
		font-size: 0.875rem;
		font-weight: 500;
		transition: background var(--transition-fast), color var(--transition-fast);
	}

	/* Scrollbar personalizada */
	::-webkit-scrollbar {
		width: 8px;
		height: 8px;
	}

	::-webkit-scrollbar-track {
		background: var(--surface-color);
		border-radius: 4px;
	}

	::-webkit-scrollbar-thumb {
		background: var(--border-dark);
		border-radius: 4px;
		transition: background var(--transition-fast);
	}

	::-webkit-scrollbar-thumb:hover {
		background: var(--text-muted);
	}

	/* Selección de texto */
	::selection {
		background: var(--primary-light);
		color: var(--primary-dark);
	}

	html.dark ::selection {
		background: var(--primary-dark);
		color: var(--primary-light);
	}

	/* Focus visible mejorado */
	*:focus-visible {
		outline: 2px solid var(--primary-color);
		outline-offset: 2px;
		border-radius: 0.375rem;
	}

	/* Transiciones suaves para todos los elementos durante el cambio de tema */
	* {
		transition: background-color var(--transition-normal), 
		           border-color var(--transition-normal), 
		           color var(--transition-normal),
		           box-shadow var(--transition-normal);
	}
</style>
